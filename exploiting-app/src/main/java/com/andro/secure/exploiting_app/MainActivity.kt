package com.andro.secure.exploiting_app

import android.content.Intent
import android.os.Bundle
import android.view.LayoutInflater
import androidx.appcompat.app.AppCompatActivity
import com.andro.secure.exploiting_app.databinding.ActivityMainBinding

class MainActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        ActivityMainBinding.inflate(LayoutInflater.from(this)).apply {
            setContentView(root)
            setupBouncingIntentButton()
            setupSensitiveIntentButton()
            setupWebViewButton()
        }
    }

    private fun ActivityMainBinding.setupWebViewButton() {
        sillyWebView.setOnClickListener {
            Intent("com.andro.secure.webview")
                .apply { putExtra("url", "http://dodgy.website/") }
                .run { startActivity(this) }
        }
    }

    private fun ActivityMainBinding.setupSensitiveIntentButton() {
        sensitiveAction.setOnClickListener {
            Intent("com.andro.secure.sensitive-action")
                .run { sendBroadcast(this) }
        }
    }

    private fun ActivityMainBinding.setupBouncingIntentButton() {
        bouncingIntentButton.setOnClickListener {
            Intent("com.andro.secure.bouncy")
                .run {
                    putExtra("bounce", buildBouncyIntent())
                }
                .run { startActivity(this) }
        }
    }

    private fun buildBouncyIntent() = Intent(this, ExploitedActivity::class.java)
}
